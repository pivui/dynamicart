function bary_traj(X, opt)
if nargin < 2
    opt = struct();
end
%
opt_default = struct('cmap', @parula,...
                     'alpha0', 0.8,...
                     'alpha_variation', 1,...
                     'last_color', [],...
                     'background', 'black',...
                     'circle',2);
%
opt = dynart.default_opt(opt, opt_default);
%
[nx, nt, ntraj] = size(X);
% if opt.alpha_variation
%     alpha_fun = @(j) opt.alpha0 * (1 - (j-1) /ntraj);
% else
%     alpha_fun = @(j) opt.alpha0;
% end
% color map
coma    = opt.cmap(ntraj);
% bounds 
m       = opt.circle * abs(min(min(min(X))));
% angles 
thetas  = pi * (0:nx-1)/nx;
% Plot 
for j = 1:ntraj
    if j == ntraj && ~isempty(opt.last_color)
        rgba = dynart.str2rgb(opt.last_color);
    else
        rgba = coma(j,:);
    end
    %
    for i = 1:nt
        z(i) = 1/nx* sum(squeeze(X(:,i,j)) .* exp(1i * thetas(:)));
    end
    %
    m
    lw      = 1 + 4 * rand();
    alpha   = 1-1/6 * lw;
    lw
    alpha
    rgba    = [rgba, alpha];
    hold on
    lh          = plot(real(z), imag(z),'linewidth',lw);
    lh.Color    = rgba;
end
%
axis equal
axis off 
set(gcf,'color',opt.background);
end
